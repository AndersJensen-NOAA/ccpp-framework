call GFS_PBL_generic_pre_run (im, levs, kinver)
call edmf_run (ix, im, levs, nvdiff, Model%ntcw, dvdt, dudt, dtdt, dqdt, Statein%ugrs, Statein%vgrs, Statein%tgrs, Statein%qgrs, Radtend%htrsw, Radtend%htrlw, xmu, Statein%prsik(:,1), rb, Sfcprop%zorl, Diag%u10m, Diag%v10m, Sfcprop%ffmm,          Sfcprop%ffhh, Sfcprop%tsfc, hflx, evap, stress, wind, kpbl, Statein%prsi, del, Statein%prsl, Statein%prslk, Statein%phii, Statein%phil, dtp, Model%dspheat, dusfc1, dvsfc1, dtsfc1, dqsfc1, Diag%hpbl, gamt, gamq, dkt, kinver, Model%xkzm_m, Model%xkzm_h, Model%xkzm_s, lprnt, ipr)
call GFS_PBL_generic_post_run (Grid, Model, Radtend, dusfc1, dvsfc1, dtsfc1, dqsfc1, dudt, dvdt, dtdt, dqdt, xmu, Diag)
call sfc_nst_pre_run (im, islmsk, Sfcprop%oro, Sfcprop%oro_uf, Sfcprop%tsfc, tsurf, tseal)
call sfc_nst_run (im, Model%lsoil, Statein%pgr, Statein%ugrs(:,1), Statein%vgrs(:,1), Statein%tgrs(:,1), Statein%qgrs(:,1,1), Sfcprop%tref, cd, cdq, Statein%prsl(:,1), work3, islmsk, Grid%xlon, Grid%sinlat, stress, Radtend%semis, gabsbdlw, adjsfcnsw, Sfcprop%tprcp, dtf, kdt, Model%solhr, xcosz, Tbd%phy_f2d(:,Model%num_p2d), flag_iter, flag_guess, Model%nstf_name(1), Model%nstf_name(4), Model%nstf_name(5), lprnt, ipr, tseal, tsurf, Sfcprop%xt, Sfcprop%xs, Sfcprop%xu, Sfcprop%xv, Sfcprop%xz, Sfcprop%zm, Sfcprop%xtts, Sfcprop%xzts, Sfcprop%dt_cool, Sfcprop%z_c, Sfcprop%c_0, Sfcprop%c_d, Sfcprop%w_0, Sfcprop%w_d, Sfcprop%d_conv, Sfcprop%ifd, Sfcprop%qrain, qss, gflx, Diag%cmm, Diag%chh, evap, hflx, ep1d)
call sfc_nst_post_run (im, islmsk, Sfcprop%oro, Sfcprop%oro_uf, Model%nstf_name(1), Model%nstf_name(4), Model%nstf_name(5), Sfcprop%xt, Sfcprop%xz, Sfcprop%dt_cool, Sfcprop%z_c, Sfcprop%slmsk, Sfcprop%tref, Grid%xlon, tsurf, dtzm, Sfcprop%tsfc)
call sasasdeep_run (im, ix, levs, dtp, del, Statein%prsl, Statein%pgr, Statein%phil, clw(:,:,1), clw(:,:,2), Stateout%gq0(:,:,1), Stateout%gt0, Stateout%gu0, Stateout%gv0, cld1d, rain1, kbot, ktop, kcnv, islmsk, garea, Statein%vvl, Model%ncld, ud_mf, dd_mf, dt_mf, cnvw, cnvc)
call gscond_run (im, ix, levs, dtp, dtf, Statein%prsl, Statein%pgr, Stateout%gq0(:,:,1), clw(:,:,1), clw(:,:,2), Stateout%gq0(:,:,Model%ntcw), Stateout%gt0, Tbd%phy_f3d(:,:,1), Tbd%phy_f3d(:,:,2), Tbd%phy_f2d(:,1), Tbd%phy_f3d(:,:,3), Tbd%phy_f3d(:,:,4), Tbd%phy_f2d(:,2), rhc, lprnt, ipr)
call precpd_run (im, ix, levs, dtp, del, Statein%prsl, Stateout%gq0(:,:,1), Stateout%gq0(:,:,Model%ntcw), Stateout%gt0, rain1, Diag%sr, rainp, rhc, Model%psautco, Model%prautco, Model%evpco, Model%wminco, work1, lprnt, ipr)
call sasasshal_run (im, ix, levs, dtp, del, Statein%prsl, Statein%pgr, Statein%phil, clw(:,:,1), clw(:,:,2), Stateout%gq0(:,:,1), Stateout%gt0, Stateout%gu0, Stateout%gv0, rain1, kbot, ktop, kcnv, islmsk, garea, Statein%vvl, Model%ncld, DIag%hpbl, ud_mf, dt_mf, cnvw, cnvc)
call sfc_ex_coef_run (im, Statein%pgr, Statein%ugrs(:,1), Statein%vgrs(:,1), Statein%tgrs(:,1), Statein%qgrs(:,1,1), Diag%zlvl, Sfcprop%snowd, Sfcprop%tsfc,  Sfcprop%zorl, cd, cdq, rb, Statein%prsl(:,1), work3, islmsk, stress, Sfcprop%ffmm,  Sfcprop%ffhh, Sfcprop%uustar, wind,  Tbd%phy_f2d(1,Model%num_p2d), fm10, fh2, sigmaf, vegtype, Sfcprop%shdmax, Model%ivegsrc, tsurf, flag_iter, Model%redrag)
call lsmnoah_run (im, Model%lsoil, Statein%pgr, Statein%ugrs(:,1), Statein%vgrs(:,1), Statein%tgrs(:,1), Statein%qgrs(:,1), soiltyp, vegtype, sigmaf, Radtend%semis, gabsbdlw, adjsfcdsw, adjsfcnsw, dtf, Sfcprop%tg3, cd, cdq, Statein%prsl(:,1), work3, DIag%zlvl, islmsk, Tbd%phy_f2d(1,Model%num_p2d), slopetyp, Sfcprop%shdmin, Sfcprop%shdmax, Sfcprop%snoalb, Radtend%sfalb, flag_iter, flag_guess, Model%isot, Model%ivegsrc, Sfcprop%weasd, Sfcprop%snowd, Sfcprop%tsfc, Sfcprop%tprcp, Sfcprop%srflag, smsoil, stsoil, slsoil, Sfcprop%canopy, trans, tsurf, Sfcprop%zorl, Sfcprop%sncovr, qss, gflx, drain, evap, hflx, ep1d, runof, Diag%cmm, Diag%chh, evbs, evcw, sbsno, snowc, Diag%soilm, snohf, Diag%smcwlt2, Diag%smcref2, Diag%wet1)
call sfc_diag_run (im, Statein%pgr, Statein%ugrs(:,1), Statein%vgrs(:,1), Statein%tgrs(:,1), Statein%qgrs(:,1), Sfcprop%tsfc, qss, Sfcprop%f10m, Diag%u10m, Diag%v10m, Sfcprop%t2m, Sfcprop%q2m, work3, evap, Sfcprop%ffmm, Sfcprop%ffhh, fm10, fh2)
call gwdps_pre_run (im, im, Model%nmtvr, Sfcprop%hprime, hprime, oc, oa4, clx, theta, sigma, gamma, elvmax)
call gwdps_run (im, ix, im, levs, dvdt, dudt, dtdt, Statein%ugrs, Statein%vgrs, Statein%tgrs, Statein%qgrs(:,:,1), kpbl, Statein%prsi, del, Statein%prsl, Statein%prslk, Statein%phii, Statein%phil, dtp, kdt, hprime, oc, oa4, clx, theta, sigma, gamma, elvmax, dusfcg, dvsfcg, con_g, con_cp, con_rd, con_rv, Model%lonr, Model%nmtvr, Model%cdmbgwd, me, lprnt, ipr)
call gwdps_post_run (Model%lssav, Model%ldiag3d, dtf, dusfcg, dvsfcg, dudt, dvdt, dtdt, Diag%dugwd, Diag%dvgwd, Diag%du3dt(:,:,2), Diag%dv3dt(:,:,2), Diag%dt3dt(:,:,2))
call rayleigh_damp_run (Model%lsidea, im, ix, im, levs, dvdt, dudt, dtdt, Statein%ugrs, Statein%vgrs, dtp, con_cp, Model%levr, Statein%pgr, Statein%prsl, Model%prslrd0, Model%ral_ts)
call gwdc_pre_run (im, Model%cgwf, Grid%dx, work1, work2, dlength, cldf, levs, kbot, ktop, dtp, Stateout%gt0, dtdt, del, cumabs)
call gwdc_run (im, ix, im, levs, 1, Statein%ugrs, Statein%vgrs, Statein%tgrs, Statein%qgrs(:,:,1), dtp, Statein%prsl, Statein%prsi, del, cumabs, ktop, kbot, kcnv, cldf, con_g, con_cp, con_rd, con_fvirt, con_pi, dlength, lprnt, ipr, Model%fhour, gwdcu, gwdcv, dusfcg, dvsfcg)
call gwdc_post_run (im, levs, Model%lssav, Model%ldiag3d, dtf, dtp, con_cp, dusfcg, dvsfcg, gwdcu, gwdcv, Diag%dugwd, Diag%dvgwd, Diag%du3dt(:,:,4), Diag%dv3dt(:,:,4), Stateout%gu0, Stateout%gv0, Stateout%gt0)
call swrad_run (plyr, plvl, tlyr, tlvl, qlyr, olyr, gasvmr_co2, gasvmr_n2o, gasvmr_ch4, gasvmr_o2, Tbd%icsdsw, aeraod, aerssa, aerasy, sfcalb(:,1), sfcalb(:,2), sfcalb(:,3), sfcalb(:,4), Radtend%coszen, Model%solcon, nday, idxday, im, lmk, lmp, Model%lprnt, cld_cf, htswc, Diag%topfsw, Radtend%sfcfsw, hsw0=htsw0, fdncmp=scmpsw, cld_lwp=cld_lwp, cld_ref_liq=cld_ref_liq, cld_iwp=cld_iwp, cld_ref_ice=cld_ref_ice, cld_rwp=cld_rwp, cld_ref_rain=cld_ref_rain, cld_swp=cld_swp, cld_ref_snow=cld_ref_snow)
call lwrad_run (plyr, plvl, tlyr, tlvl, qlyr, olyr, gasvmr(:,:,1), gasvmr(:,:,2), gasvmr(:,:,3), gasvmr(:,:,4), gasvmr(:,:,5), gasvmr(:,:,6), gasvmr(:,:,7), gasvmr(:,:,8), gasvmr(:,:,9), Tbd%icsdlw, faerlw(:,:,:,1), faerlw(:,:,:,2), Radtend%semis, tsfg, im, lmk, lmp, Model%lprnt, clouds(:,:,1), htlwc, Diag%topflw, Radtend%sfcflw, hlw0=htlw0, cld_od=clouds(:,:,2))
call GFS_calpreciptype_run (kdt, Model%nrcm, im, ix, levs, levs+1, Tbd%rann, Model%cal_pre, Stateout%gt0, Stateout%gq0, Statein%prsl, Statein%prsi, Diag%rain, Statein%phii, Model%num_p3d, Sfcprop%tsfc, Diag%sr, Tbd%phy_f3d(:,:,i), domr, domzr, domip, doms, Sfcprop%srflag, Sfcprop%tprcp)
call get_prs_fv3_run (ix, levs, Statein%phii, Statein%prsi, Statein%tgrs, Statein%qgrs(:,:,1), del, del_gz)
call dcyc2t3_run (Model%solhr, Model%slag, Model%sdec, Model%cdec, Grid%sinlat, Grid%coslat, Grid%xlon, Radtend%coszen, Sfcprop%tsfc, Statein%tgrs(:,1), Radtend%tsflw, Radtend%semis, Coupling%sfcdsw, Coupling%sfcnsw, Coupling%sfcdlw, Radtend%htrsw, Radtend%swhc, Radtend%htrlw, Radtend%lwhc, Coupling%nirbmui, Coupling%nirdfui, Coupling%visbmui, Coupling%visdfui, Coupling%nirbmdi, Coupling%nirdfdi, Coupling%visbmdi, Coupling%visdfdi, ix, im, levs, dtdt, dtdtc, adjsfcdsw, adjsfcnsw, adjsfcdlw, adjsfculw, xmu, xcosz, adjnirbmu, adjnirdfu, adjvisbmu, adjvisdfu, adjnirbmd, adjnirdfd, adjvisbmd, adjvisdfd)
call get_phi_fv3_run (ix, levs, Stateout%gt0, Stateout%gq0(:,:,1), del_gz, Statein%phii, Statein%phil)
call cnvc90_run (Model%clstp, im, ix, Diag%rainc, kbot, ktop, levs, Statein%prsi, Tbd%acv, Tbd%acvb, Tbd%acvt, Cldprop%cv, Cldprop%cvb, Cldprop%cvt)
call GFS_MP_generic_post_run (im, ix, levs, dtf, del, Model%lssav, Model%ldiag3d, Diag%rain, frain, Model%ntcw, Model%ncld, Stateout%gq0(:,:,Model%ntcw), Stateout%gt0, Stateout%gq0(:,:,1), dtdt, dqdt(:,:,1), Diag%totprcp, Diag%dt3dt(:,:,6), Diag%dq3dt(:,:,6), Diag%pwat)
